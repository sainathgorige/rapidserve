{"uuid": "44a02d4f-16ae-4242-b89a-9ad0650f9cb9", "counter": 25, "stdout": "", "start_line": 24, "end_line": 24, "runner_ident": "7489ad1d-fe7a-49fa-a760-2a1dbfd7f6f1", "event": "runner_on_ok", "pid": 1283844, "created": "2024-04-26T02:55:29.422362", "parent_uuid": "52540038-3809-f5fa-3436-00000000000a", "event_data": {"playbook": "/home/vmadm/demo/RapidServe/southbound/deploy_con.yaml", "playbook_uuid": "c2bf8aec-9007-4c9f-b0b8-5d9d3dbd85ae", "play": "Deploy Infrastructure with Docker Containers for Edge and Origin Servers", "play_uuid": "52540038-3809-f5fa-3436-000000000002", "play_pattern": "hostvms", "task": "Configure network interfaces and veth pairs", "task_uuid": "52540038-3809-f5fa-3436-00000000000a", "task_action": "shell", "resolved_action": "ansible.builtin.shell", "task_args": "", "task_path": "/home/vmadm/demo/RapidServe/southbound/deploy_con.yaml:77", "host": "192.168.38.9", "remote_addr": "192.168.38.9", "res": {"results": [{"changed": true, "stdout": "", "stderr": "+ echo la_ge_container1\n+ cut -c1-8\n+ short_name_prefix=la_ge_co\n+ echo la_ge_container1\n+ rev\n+ cut -c1-2\n+ rev\n+ short_name_suffix=r1\n+ short_name=la_ge_co_r1\n+ ip link add la_ge_co_r1 type veth peer name v_la_ge_co_r1\n+ ip link set v_la_ge_co_r1 up\n+ ip link set v_la_ge_co_r1 master la_ge_S1_br\n+ ip link set la_ge_co_r1 netns la_ge_container1\n+ ip netns exec la_ge_container1 ip link set la_ge_co_r1 up\n+ docker exec la_ge_container1 dhclient la_ge_co_r1\n+ docker exec la_ge_container1 ip addr show la_ge_co_r1\n+ + awk {print $2}\ncut -d/ -f1\n+ grep inet \n+ IP_ADDR=172.16.172.100\n+ [ -n 172.16.172.100 ]\n+ echo 172.16.172.100\n+ awk -F . {printf \"%d.%d.%d.1\", $1, $2, $3}\n+ GATEWAY=172.16.172.1\n+ docker exec la_ge_container1 ip route\n+ grep default\n+ DEFAULT_ROUTE=default via 172.16.172.1 dev la_ge_co_r1 \n+ [ -z default via 172.16.172.1 dev la_ge_co_r1  ]", "rc": 0, "cmd": "set -x\nshort_name_prefix=\"$(echo 'la_ge_container1' | cut -c1-8)\"\nshort_name_suffix=\"$(echo 'la_ge_container1' | rev | cut -c1-2 | rev)\"\nshort_name=\"${short_name_prefix}_${short_name_suffix}\"\n#short_name=\"$(echo 'la_ge_container1' | cut -c1-8)_$(echo 'la_ge_container1' | rev | cut -c1-2 | rev)\"\n# Create veth pair for bridge\nip link add ${short_name} type veth peer name v_${short_name}\n# Bring up veth peer in host namespace for bridge\nip link set v_${short_name} up\n# Attach veth interface to the bridge\nip link set v_${short_name} master la_ge_S1_br\n# Assign container network interface to veth\nip link set ${short_name} netns 'la_ge_container1'\n# Bring up container network interface in container namespace for bridge\nip netns exec 'la_ge_container1' ip link set ${short_name} up\n# Start dhclient on container interface (Optional based on setup)\ndocker exec 'la_ge_container1' dhclient ${short_name}\n    # Check and add default route if not exists\nIP_ADDR=$(docker exec 'la_ge_container1' ip addr show ${short_name} | grep 'inet ' | awk '{print $2}' | cut -d'/' -f1)\nif [ -n \"$IP_ADDR\" ]; then\n  GATEWAY=$(echo $IP_ADDR | awk -F '.' '{printf \"%d.%d.%d.1\", $1, $2, $3}')\n  DEFAULT_ROUTE=$(docker exec 'la_ge_container1' ip route | grep default)\n  if [ -z \"$DEFAULT_ROUTE\" ]; then\n    docker exec 'la_ge_container1' ip route add default via $GATEWAY\n  fi\nfi\n", "start": "2024-04-26 02:55:25.847239", "end": "2024-04-26 02:55:29.330860", "delta": "0:00:03.483621", "msg": "", "invocation": {"module_args": {"_raw_params": "set -x\nshort_name_prefix=\"$(echo 'la_ge_container1' | cut -c1-8)\"\nshort_name_suffix=\"$(echo 'la_ge_container1' | rev | cut -c1-2 | rev)\"\nshort_name=\"${short_name_prefix}_${short_name_suffix}\"\n#short_name=\"$(echo 'la_ge_container1' | cut -c1-8)_$(echo 'la_ge_container1' | rev | cut -c1-2 | rev)\"\n# Create veth pair for bridge\nip link add ${short_name} type veth peer name v_${short_name}\n# Bring up veth peer in host namespace for bridge\nip link set v_${short_name} up\n# Attach veth interface to the bridge\nip link set v_${short_name} master la_ge_S1_br\n# Assign container network interface to veth\nip link set ${short_name} netns 'la_ge_container1'\n# Bring up container network interface in container namespace for bridge\nip netns exec 'la_ge_container1' ip link set ${short_name} up\n# Start dhclient on container interface (Optional based on setup)\ndocker exec 'la_ge_container1' dhclient ${short_name}\n    # Check and add default route if not exists\nIP_ADDR=$(docker exec 'la_ge_container1' ip addr show ${short_name} | grep 'inet ' | awk '{print $2}' | cut -d'/' -f1)\nif [ -n \"$IP_ADDR\" ]; then\n  GATEWAY=$(echo $IP_ADDR | awk -F '.' '{printf \"%d.%d.%d.1\", $1, $2, $3}')\n  DEFAULT_ROUTE=$(docker exec 'la_ge_container1' ip route | grep default)\n  if [ -z \"$DEFAULT_ROUTE\" ]; then\n    docker exec 'la_ge_container1' ip route add default via $GATEWAY\n  fi\nfi\n", "_uses_shell": true, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}, "stdout_lines": [], "stderr_lines": ["+ echo la_ge_container1", "+ cut -c1-8", "+ short_name_prefix=la_ge_co", "+ echo la_ge_container1", "+ rev", "+ cut -c1-2", "+ rev", "+ short_name_suffix=r1", "+ short_name=la_ge_co_r1", "+ ip link add la_ge_co_r1 type veth peer name v_la_ge_co_r1", "+ ip link set v_la_ge_co_r1 up", "+ ip link set v_la_ge_co_r1 master la_ge_S1_br", "+ ip link set la_ge_co_r1 netns la_ge_container1", "+ ip netns exec la_ge_container1 ip link set la_ge_co_r1 up", "+ docker exec la_ge_container1 dhclient la_ge_co_r1", "+ docker exec la_ge_container1 ip addr show la_ge_co_r1", "+ + awk {print $2}", "cut -d/ -f1", "+ grep inet ", "+ IP_ADDR=172.16.172.100", "+ [ -n 172.16.172.100 ]", "+ echo 172.16.172.100", "+ awk -F . {printf \"%d.%d.%d.1\", $1, $2, $3}", "+ GATEWAY=172.16.172.1", "+ docker exec la_ge_container1 ip route", "+ grep default", "+ DEFAULT_ROUTE=default via 172.16.172.1 dev la_ge_co_r1 ", "+ [ -z default via 172.16.172.1 dev la_ge_co_r1  ]"], "_ansible_no_log": null, "failed": false, "failed_when_result": false, "item": "la_ge_S1", "ansible_loop_var": "item", "_ansible_item_label": "la_ge_S1"}], "changed": true, "msg": "All items completed"}, "start": "2024-04-26T02:55:25.449230", "end": "2024-04-26T02:55:29.422225", "duration": 3.972995, "event_loop": null, "uuid": "44a02d4f-16ae-4242-b89a-9ad0650f9cb9"}}