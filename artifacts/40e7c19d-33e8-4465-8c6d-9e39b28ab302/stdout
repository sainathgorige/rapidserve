[0;34mNo config file found; using defaults[0m

PLAY [Deploy subnet Infrastructure with bridges and Veth Pairs] ****************

TASK [Parse retrieved data] ****************************************************
[0;32mok: [192.168.38.9] => {"ansible_facts": {"tenant_data_parsed": {"containers": [{"container_state": "requested", "name": "sn_ge_container1", "subnets": ["sn_ge_S1"], "vpc": "sn_ge"}], "name": "sn_is_stupid", "numberOfVpcs": "1", "regional_vpcs": {"asia_vpcs": [], "europe_vpcs": [{"name": "sn_ge"}], "vni": 1100}, "subnets": [{"CIDR": "192.168.20.0/24", "dhcp_end": "192.168.20.254", "dhcp_start": "192.168.20.2", "ip": "192.168.20.1", "name": "sn_ge_S1", "subnet_state": "requested", "vpc": "sn_ge"}], "tunnel_state": "active", "vpcs": [{"name": "sn_ge", "vpc_state": "active"}]}}, "changed": false}[0m

TASK [Debug tenant_data_parsed] ************************************************
[0;32mok: [192.168.38.9] => {[0m
[0;32m    "tenant_data_parsed": {[0m
[0;32m        "containers": [[0m
[0;32m            {[0m
[0;32m                "container_state": "requested",[0m
[0;32m                "name": "sn_ge_container1",[0m
[0;32m                "subnets": [[0m
[0;32m                    "sn_ge_S1"[0m
[0;32m                ],[0m
[0;32m                "vpc": "sn_ge"[0m
[0;32m            }[0m
[0;32m        ],[0m
[0;32m        "name": "sn_is_stupid",[0m
[0;32m        "numberOfVpcs": "1",[0m
[0;32m        "regional_vpcs": {[0m
[0;32m            "asia_vpcs": [],[0m
[0;32m            "europe_vpcs": [[0m
[0;32m                {[0m
[0;32m                    "name": "sn_ge"[0m
[0;32m                }[0m
[0;32m            ],[0m
[0;32m            "vni": 1100[0m
[0;32m        },[0m
[0;32m        "subnets": [[0m
[0;32m            {[0m
[0;32m                "CIDR": "192.168.20.0/24",[0m
[0;32m                "dhcp_end": "192.168.20.254",[0m
[0;32m                "dhcp_start": "192.168.20.2",[0m
[0;32m                "ip": "192.168.20.1",[0m
[0;32m                "name": "sn_ge_S1",[0m
[0;32m                "subnet_state": "requested",[0m
[0;32m                "vpc": "sn_ge"[0m
[0;32m            }[0m
[0;32m        ],[0m
[0;32m        "tunnel_state": "active",[0m
[0;32m        "vpcs": [[0m
[0;32m            {[0m
[0;32m                "name": "sn_ge",[0m
[0;32m                "vpc_state": "active"[0m
[0;32m            }[0m
[0;32m        ][0m
[0;32m    }[0m
[0;32m}[0m

TASK [Create bridges for each subnet] ******************************************
[0;33mchanged: [192.168.38.9] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3"}, "changed": true, "cmd": ["ip", "link", "add", "sn_ge_S1_br", "type", "bridge"], "delta": "0:00:00.013175", "end": "2024-04-23 23:09:57.819490", "msg": "", "rc": 0, "start": "2024-04-23 23:09:57.806315", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m

TASK [Activate bridges for each subnet] ****************************************
[0;33mchanged: [192.168.38.9] => {"changed": true, "cmd": ["ip", "link", "set", "sn_ge_S1_br", "up"], "delta": "0:00:00.007916", "end": "2024-04-23 23:09:58.315465", "msg": "", "rc": 0, "start": "2024-04-23 23:09:58.307549", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m

TASK [Create veth pair for each subnet] ****************************************
[0;33mchanged: [192.168.38.9] => {"changed": true, "cmd": ["ip", "link", "add", "sn_ge_S1_veth0", "type", "veth", "peer", "name", "sn_ge_S1_veth1"], "delta": "0:00:00.009617", "end": "2024-04-23 23:09:58.812247", "msg": "", "rc": 0, "start": "2024-04-23 23:09:58.802630", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m

TASK [Bring up veth0 interface in the root namespace] **************************
[0;33mchanged: [192.168.38.9] => {"changed": true, "cmd": ["ip", "link", "set", "sn_ge_S1_veth0", "up"], "delta": "0:00:00.007875", "end": "2024-04-23 23:09:59.311642", "msg": "", "rc": 0, "start": "2024-04-23 23:09:59.303767", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m

TASK [Move one end of the veth pair (veth1) to the corresponding namespace] ****
[0;33mchanged: [192.168.38.9] => {"changed": true, "cmd": ["ip", "link", "set", "sn_ge_S1_veth1", "netns", "sn_ge"], "delta": "0:00:00.042405", "end": "2024-04-23 23:09:59.782141", "msg": "", "rc": 0, "start": "2024-04-23 23:09:59.739736", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m

TASK [Bring up veth1 interface in its respective namespace] ********************
[0;33mchanged: [192.168.38.9] => {"changed": true, "cmd": ["ip", "netns", "exec", "sn_ge", "ip", "link", "set", "sn_ge_S1_veth1", "up"], "delta": "0:00:00.014012", "end": "2024-04-23 23:10:00.256972", "msg": "", "rc": 0, "start": "2024-04-23 23:10:00.242960", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m

TASK [Attach veth0 to the bridge in default namespace] *************************
[0;33mchanged: [192.168.38.9] => {"changed": true, "cmd": ["ip", "link", "set", "sn_ge_S1_veth0", "master", "sn_ge_S1_br"], "delta": "0:00:00.014988", "end": "2024-04-23 23:10:00.756276", "msg": "", "rc": 0, "start": "2024-04-23 23:10:00.741288", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m

TASK [Assign IP addresses to veth1 interfaces within namespaces] ***************
[0;33mchanged: [192.168.38.9] => {"changed": true, "cmd": ["ip", "netns", "exec", "sn_ge", "ip", "addr", "add", "192.168.20.1/24", "dev", "sn_ge_S1_veth1"], "delta": "0:00:00.013935", "end": "2024-04-23 23:10:01.269282", "msg": "", "rc": 0, "start": "2024-04-23 23:10:01.255347", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m

TASK [Setup DHCP on veth1 interfaces within namespaces] ************************
[0;33mchanged: [192.168.38.9] => {"changed": true, "cmd": ["ip", "netns", "exec", "sn_ge", "dnsmasq", "--interface=sn_ge_S1_veth1", "--bind-interfaces", "--dhcp-range=192.168.20.2,192.168.20.254,24h", "--except-interface=lo"], "delta": "0:00:00.025455", "end": "2024-04-23 23:10:01.795537", "msg": "", "rc": 0, "start": "2024-04-23 23:10:01.770082", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m

TASK [Fetch IP address for the interface based on location] ********************
[0;32mok: [192.168.38.9] => {"changed": false, "cmd": "ip netns exec sn_ge ip -o -4 addr show sn_ge_veth1 | awk '{print $4}' | cut -d/ -f1\n", "delta": "0:00:00.019588", "end": "2024-04-23 23:10:02.307968", "msg": "", "rc": 0, "start": "2024-04-23 23:10:02.288380", "stderr": "", "stderr_lines": [], "stdout": "192.168.100.250", "stdout_lines": ["192.168.100.250"]}[0m

TASK [Set vpc_veth1_ip variable] ***********************************************
[0;32mok: [192.168.38.9] => {"ansible_facts": {"vpc_veth1_ip": "192.168.100.250"}, "changed": false}[0m

TASK [Debug vpc_veth1_ip] ******************************************************
[0;32mok: [192.168.38.9] => {[0m
[0;32m    "vpc_veth1_ip": "192.168.100.250"[0m
[0;32m}[0m

TASK [Add route in root namespace to reach VPC subnet via vpc_veth1 IP] ********
[0;31mfatal: [192.168.38.9]: FAILED! => {"changed": true, "cmd": ["ip", "route", "add", "192.168.20.0/24", "via", "192.168.100.250"], "delta": "0:00:00.008961", "end": "2024-04-23 23:10:02.889093", "msg": "non-zero return code", "rc": 2, "start": "2024-04-23 23:10:02.880132", "stderr": "RTNETLINK answers: File exists", "stderr_lines": ["RTNETLINK answers: File exists"], "stdout": "", "stdout_lines": []}[0m

PLAY RECAP *********************************************************************
[0;31m192.168.38.9[0m               : [0;32mok=14  [0m [0;33mchanged=9   [0m unreachable=0    [0;31mfailed=1   [0m skipped=0    rescued=0    ignored=0   
